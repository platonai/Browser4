<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DOM Events - Keyboard Testing</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .test-area {
            margin: 20px 0;
            padding: 20px;
            border: 2px solid #ccc;
            background: #f9f9f9;
        }
        .keyboard-demo {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin: 20px 0;
        }
        .key {
            background: #333;
            color: white;
            padding: 10px 15px;
            border-radius: 5px;
            min-width: 40px;
            text-align: center;
            font-family: monospace;
            font-weight: bold;
            box-shadow: 0 2px 5px rgba(0,0,0,0.3);
            transition: all 0.1s ease;
        }
        .key.active {
            background: #4CAF50;
            transform: translateY(2px);
            box-shadow: 0 1px 2px rgba(0,0,0,0.3);
        }
        .input-field {
            width: 100%;
            padding: 15px;
            font-size: 16px;
            border: 2px solid #ddd;
            border-radius: 5px;
            margin: 10px 0;
        }
        .input-field:focus {
            outline: none;
            border-color: #4CAF50;
            box-shadow: 0 0 5px rgba(76, 175, 80, 0.3);
        }
        .result {
            margin: 10px 0;
            padding: 10px;
            background: #f5f5f5;
            border-left: 4px solid #333;
            font-family: monospace;
            font-size: 14px;
        }
        .shortcut-demo {
            background: #e3f2fd;
            padding: 15px;
            border-radius: 5px;
            margin: 10px 0;
        }
        .event-log {
            max-height: 200px;
            overflow-y: auto;
            background: #000;
            color: #0f0;
            padding: 10px;
            font-family: monospace;
            font-size: 12px;
            margin: 10px 0;
        }
        .key-info {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 10px;
            margin: 10px 0;
        }
        .key-info-item {
            background: #fff;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 3px;
        }
        .prevented {
            background: #ffebee !important;
            border-color: #f44336 !important;
        }
    </style>
</head>
<body>
    <h1>DOM Events - Keyboard Testing</h1>

    <div class="test-area">
        <h2>Basic Keyboard Events</h2>
        <input type="text" class="input-field" id="basicInput" placeholder="Type here to test basic keyboard events...">
        <div class="key-info" id="keyInfo">
            <div class="key-info-item"><strong>Key:</strong> <span id="currentKey">None</span></div>
            <div class="key-info-item"><strong>Code:</strong> <span id="currentCode">None</span></div>
            <div class="key-info-item"><strong>KeyCode:</strong> <span id="currentKeyCode">None</span></div>
            <div class="key-info-item"><strong>Modifiers:</strong> <span id="currentModifiers">None</span></div>
        </div>
        <div id="basicResult" class="result"></div>
    </div>

    <div class="test-area">
        <h2>Key Sequence Detection</h2>
        <input type="text" class="input-field" id="sequenceInput" placeholder="Try typing: "hello", "test", or "password"...">
        <div id="sequenceResult" class="result"></div>
    </div>

    <div class="test-area">
        <h2>Keyboard Shortcuts Demo</h2>
        <div class="shortcut-demo">
            <p><strong>Try these shortcuts:</strong></p>
            <ul>
                <li><code>Ctrl+S</code> - Save (prevented)</li>
                <li><code>Ctrl+A</code> - Select all (prevented)</li>
                <li><code>Ctrl+Z</code> - Undo (prevented)</li>
                <li><code>Ctrl+Y</code> - Redo (prevented)</li>
                <li><code>Escape</code> - Cancel</li>
                <li><code>F1</code> - Help (prevented)</li>
                <li><code>Alt+F4</code> - Close (won't work in browser)</li>
            </ul>
        </div>
        <div id="shortcutResult" class="result"></div>
    </div>

    <div class="test-area">
        <h2>Virtual Keyboard Display</h2>
        <div class="keyboard-demo" id="virtualKeyboard">
            <!-- Keys will be generated by JavaScript -->
        </div>
        <div id="keyboardResult" class="result"></div>
    </div>

    <div class="test-area">
        <h2>Input Validation</h2>
        <input type="text" class="input-field" id="validationInput" placeholder="Type numbers only (max 5 digits)...">
        <div id="validationResult" class="result"></div>
    </div>

    <div class="test-area">
        <h2>Textarea with Tab Support</h2>
        <textarea class="input-field" id="textareaInput" rows="4" placeholder="Type here. Press Tab to indent (normally prevented)..."></textarea>
        <div id="textareaResult" class="result"></div>
    </div>

    <div class="test-area">
        <h2>Event Log</h2>
        <div id="eventLog" class="event-log"></div>
    </div>

    <script>
        // Event logging utility
        function logEvent(type, details) {
            const eventLog = document.getElementById('eventLog');
            const timestamp = new Date().toLocaleTimeString();
            const logEntry = `[${timestamp}] ${type}: ${details}`;
            eventLog.innerHTML += logEntry + '\n';
            eventLog.scrollTop = eventLog.scrollHeight;
            console.log(logEntry);
        }

        // Virtual keyboard setup
        const keys = [
            'Q', 'W', 'E', 'R', 'T', 'Y', 'U', 'I', 'O', 'P',
            'A', 'S', 'D', 'F', 'G', 'H', 'J', 'K', 'L',
            'Z', 'X', 'C', 'V', 'B', 'N', 'M'
        ];

        const virtualKeyboard = document.getElementById('virtualKeyboard');
        keys.forEach(key => {
            const keyElement = document.createElement('div');
            keyElement.className = 'key';
            keyElement.textContent = key;
            keyElement.id = `key-${key}`;
            virtualKeyboard.appendChild(keyElement);
        });

        // Basic keyboard events
        const basicInput = document.getElementById('basicInput');
        const basicResult = document.getElementById('basicResult');
        const currentKey = document.getElementById('currentKey');
        const currentCode = document.getElementById('currentCode');
        const currentKeyCode = document.getElementById('currentKeyCode');
        const currentModifiers = document.getElementById('currentModifiers');

        function updateKeyInfo(e) {
            currentKey.textContent = e.key || 'None';
            currentCode.textContent = e.code || 'None';
            currentKeyCode.textContent = e.keyCode || 'None';

            const modifiers = [];
            if (e.ctrlKey) modifiers.push('Ctrl');
            if (e.shiftKey) modifiers.push('Shift');
            if (e.altKey) modifiers.push('Alt');
            if (e.metaKey) modifiers.push('Meta');

            currentModifiers.textContent = modifiers.length > 0 ? modifiers.join('+') : 'None';
        }

        basicInput.addEventListener('keydown', function(e) {
            updateKeyInfo(e);
            const msg = `keydown: key="${e.key}", code="${e.code}", keyCode=${e.keyCode}`;
            basicResult.innerHTML = msg;
            logEvent('keydown', msg);

            // Highlight virtual key
            const virtualKey = document.getElementById(`key-${e.key.toUpperCase()}`);
            if (virtualKey) {
                virtualKey.classList.add('active');
            }
        });

        basicInput.addEventListener('keyup', function(e) {
            updateKeyInfo(e);
            const msg = `keyup: key="${e.key}", code="${e.code}", keyCode=${e.keyCode}`;
            basicResult.innerHTML += `<br>${msg}`;
            logEvent('keyup', msg);

            // Remove highlight from virtual key
            const virtualKey = document.getElementById(`key-${e.key.toUpperCase()}`);
            if (virtualKey) {
                virtualKey.classList.remove('active');
            }
        });

        basicInput.addEventListener('keypress', function(e) {
            const msg = `keypress: key="${e.key}", charCode=${e.charCode}`;
            basicResult.innerHTML += `<br><span style="color: green;">${msg}</span>`;
            logEvent('keypress', msg);
        });

        // Key sequence detection
        const sequenceInput = document.getElementById('sequenceInput');
        const sequenceResult = document.getElementById('sequenceResult');
        let keySequence = '';

        sequenceInput.addEventListener('input', function(e) {
            keySequence = this.value.toLowerCase();

            if (keySequence.includes('hello')) {
                sequenceResult.innerHTML = '<span style="color: green; font-weight: bold;">Hello detected! üéâ</span>';
                logEvent('sequence', 'Detected sequence: "hello"');
            } else if (keySequence.includes('test')) {
                sequenceResult.innerHTML = '<span style="color: blue; font-weight: bold;">Test detected! ‚úÖ</span>';
                logEvent('sequence', 'Detected sequence: "test"');
            } else if (keySequence.includes('password')) {
                sequenceResult.innerHTML = '<span style="color: red; font-weight: bold;">Password detected! üîí</span>';
                logEvent('sequence', 'Detected sequence: "password"');
            } else {
                sequenceResult.innerHTML = `Current sequence: "${keySequence}"`;
            }
        });

        // Keyboard shortcuts
        const shortcutResult = document.getElementById('shortcutResult');

        document.addEventListener('keydown', function(e) {
            let shortcutDetected = false;
            let prevented = false;

            // Check for various shortcuts
            if (e.ctrlKey || e.metaKey) {
                switch(e.key.toLowerCase()) {
                    case 's':
                        e.preventDefault();
                        prevented = true;
                        shortcutResult.innerHTML = '<span style="color: orange; font-weight: bold;">Ctrl+S (Save) detected and prevented! üíæ</span>';
                        shortcutDetected = true;
                        break;
                    case 'a':
                        e.preventDefault();
                        prevented = true;
                        shortcutResult.innerHTML = '<span style="color: blue; font-weight: bold;">Ctrl+A (Select All) detected and prevented! üìã</span>';
                        shortcutDetected = true;
                        break;
                    case 'z':
                        e.preventDefault();
                        prevented = true;
                        shortcutResult.innerHTML = '<span style="color: purple; font-weight: bold;">Ctrl+Z (Undo) detected and prevented! ‚Ü∂</span>';
                        shortcutDetected = true;
                        break;
                    case 'y':
                        e.preventDefault();
                        prevented = true;
                        shortcutResult.innerHTML = '<span style="color: green; font-weight: bold;">Ctrl+Y (Redo) detected and prevented! ‚Ü∑</span>';
                        shortcutDetected = true;
                        break;
                }
            } else if (e.key === 'Escape') {
                shortcutResult.innerHTML = '<span style="color: red; font-weight: bold;">Escape key pressed! Canceling... ‚úñ</span>';
                shortcutDetected = true;
            } else if (e.key === 'F1') {
                e.preventDefault();
                prevented = true;
                shortcutResult.innerHTML = '<span style="color: teal; font-weight: bold;">F1 (Help) detected and prevented! ‚ùì</span>';
                shortcutDetected = true;
            }

            if (shortcutDetected) {
                logEvent('shortcut', `Detected: ${e.key} (prevented: ${prevented})`);

                // Add visual feedback
                if (prevented) {
                    document.body.classList.add('prevented');
                    setTimeout(() => {
                        document.body.classList.remove('prevented');
                    }, 200);
                }
            }
        });

        // Input validation
        const validationInput = document.getElementById('validationInput');
        const validationResult = document.getElementById('validationResult');

        validationInput.addEventListener('keypress', function(e) {
            const char = String.fromCharCode(e.charCode);
            const isNumber = /\d/.test(char);
            const currentLength = this.value.length;

            if (!isNumber || currentLength >= 5) {
                e.preventDefault();
                validationResult.innerHTML = `<span style="color: red;">Invalid input: "${char}" (only ${5 - currentLength} digits allowed)</span>`;
                logEvent('validation', `Blocked character: "${char}"`);
            } else {
                validationResult.innerHTML = `<span style="color: green;">Valid digit: "${char}" (${4 - currentLength} remaining)</span>`;
            }
        });

        validationInput.addEventListener('input', function(e) {
            if (this.value.length > 5) {
                this.value = this.value.slice(0, 5);
            }
        });

        // Textarea with Tab support
        const textareaInput = document.getElementById('textareaInput');
        const textareaResult = document.getElementById('textareaResult');

        textareaInput.addEventListener('keydown', function(e) {
            if (e.key === 'Tab') {
                e.preventDefault();
                const start = this.selectionStart;
                const end = this.selectionEnd;
                const value = this.value;

                // Insert 4 spaces for tab
                this.value = value.substring(0, start) + '    ' + value.substring(end);
                this.selectionStart = this.selectionEnd = start + 4;

                textareaResult.innerHTML = '<span style="color: blue;">Tab pressed - inserted 4 spaces</span>';
                logEvent('tab', 'Tab key pressed and handled');
            }
        });

        // Global keyboard events
        document.addEventListener('keydown', function(e) {
            // Log all keydown events (but not too frequently)
            if (Math.random() < 0.1) { // Log ~10% of global events
                logEvent('document.keydown', `Global: key="${e.key}", code="${e.code}"`);
            }
        });

        // Trigger some initial events for testing
        setTimeout(() => {
            console.log('DOM Events Keyboard page loaded');
            logEvent('page', 'DOM Events Keyboard page loaded');

            // Focus the first input
            basicInput.focus();
        }, 1000);
    </script>
</body>
</html>